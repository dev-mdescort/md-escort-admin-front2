(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1679],{91342:function(e,n,t){"use strict";t.d(n,{SA:function(){return p},ko:function(){return d},FC:function(){return h}});var r=t(87757),u=t.n(r),s=t(92137),o=t(85893),a=t(8286),i=t(67294),c=t(66199),l=t(67102),f=t(57714);function p(e){return(0,o.jsx)(a.Z,{fullWidth:!0,variant:"outlined",onChange:function(n){var t,r={formResults:{some:{title:{startsWith:"\ud658\uc790 \uae30\ubcf8\uc815\ubcf4"},outputs:{some:{label:{startsWith:"\ud658\uc790 \uc131\ud568"},values:{equals:[n.target.value]}}}}}};e.onChange(r),null===(t=e.onChangeValue)||void 0===t||t.call(e,n.target.value)},label:"\ud658\uc790\uba85"})}function d(e){var n=(0,c.Z)(),t=n.fetchHospitals,r=n.hospitals;(0,i.useEffect)((function(){a()}),[]);var a=function(){var e=(0,s.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=(0,i.useMemo)((function(){return[{label:"\uc804\uccb4",value:void 0}].concat(r.map((function(e){return{label:e.name,value:e.id}})))}),[r]);return(0,o.jsx)(f.Z,{title:"\ubcd1\uc6d0",options:l,onChangeValue:function(n){if(n){var t={escorts:{some:{hospitalId:{equals:n}}}};e.onChange(t)}else e.onChange({escorts:null})}})}function h(e){var n=(0,i.useMemo)((function(){return[{label:"\uc804\uccb4",value:void 0},{label:"\uc77c\ubc18",value:l.l9.Normal},{label:"VIP",value:l.l9.Vip}]}),[]);return(0,o.jsx)(f.Z,{title:"\ud658\uc790\ud0c0\uc785(\uc77c\ubc18/VIP)",options:n,onChangeValue:function(n){if(n){var t={type:n};e.onChange(t)}else e.onChange({type:null})}})}},94:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(96156),u=t(11163),s=t(67294);function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e){var n,t=(0,u.useRouter)(),o=(0,s.useState)(e.defaultValue),i=o[0],c=o[1];function l(e,n){t.push({pathname:t.pathname,query:a(a({},t.query),{},(0,r.Z)({},e,n))}),c(n)}function f(e,n){t.replace({pathname:t.pathname,query:a(a({},t.query),{},(0,r.Z)({},e,n))}),c(n)}return(0,s.useEffect)((function(){var n;e.dep&&(null===(n=t.query)||void 0===n?void 0:n[e.param])!==i&&f(e.param,e.defaultValue)}),[e.dep]),(0,s.useEffect)((function(){var n,r,u,s,o;null!==(n=t.query)&&void 0!==n&&n[e.param]&&i&&(null===(r=t.query)||void 0===r?void 0:r[e.param])!==i&&(null===(u=e.onChange)||void 0===u||u.call(e,null===(s=t.query)||void 0===s?void 0:s[e.param]),c(null===(o=t.query)||void 0===o?void 0:o[e.param]))}),[null===(n=t.query)||void 0===n?void 0:n[e.param]]),(0,s.useEffect)((function(){e.pushWhen&&(null===l||void 0===l||l(e.param,e.pushValue))}),[e.pushWhen]),(0,s.useEffect)((function(){e.replaceWhen&&(null===f||void 0===f||f(e.param,e.replaceValue))}),[e.replaceWhen]),{pushValue:l,replaceValue:f}}},92811:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ce}});var r=t(85893),u=t(96156),s=t(41749),o=t(95757),a=t(95477),i=t(55517),c=t(64436),l=t(96019),f=t(67162),p=t(30553),d=t(40074),h=t(67294),v=t(91342),j=t(28738),m=t(9844),y=t(87757),Z=t.n(y),b=t(92137),x=t(82285),g=t(18463),w=t(52663),O=t(17812),C=t(64566),P=t(62822),k=t(50998);function S(e){var n,t;return(0,r.jsxs)(P.Z,{children:[(0,r.jsx)(k.Z,{children:(0,r.jsx)(o.Z,{primary:"\uace0\uac1d\uba85",secondary:null===(n=e.user)||void 0===n?void 0:n.name})}),(0,r.jsx)(k.Z,{children:(0,r.jsx)(o.Z,{primary:"\uace0\uac1d\uc5f0\ub77d\ucc98",secondary:null===(t=e.user)||void 0===t?void 0:t.phoneNum})})]})}var A=t(96837),E=t(43031),q=t(12670),D=t(38797),V=t(47446),W=t(99457),_=t(50760);function T(e){var n=(0,W.Z)(),t=n.Snack,u=n.showMessage,s=(0,q.Z)({onCatch:function(e){return u(e.message)}}).play,o=(0,D.Z)(),a=o.fetchPatients,i=o.patients,c=(0,V.Z)(),l=c.fetchPatientCount,f=c.patientsCount,p=(0,h.useState)(5),d=p[0],v=(p[1],(0,h.useState)()),j=v[0],m=v[1],y=(0,h.useState)(1),x=y[0],g=y[1],w=function(){var n=(0,b.Z)(Z().mark((function n(){return Z().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s((0,b.Z)(Z().mark((function n(){return Z().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l({where:e.where}),n.next=3,a({where:e.where,skip:j,take:d});case 3:case"end":return n.stop()}}),n)}))));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();(0,_.Z)({timeout:750,onTimeout:w,dependencies:[e.where,j,d]}),(0,h.useEffect)((function(){g(1),m(void 0)}),[e.where]);return(0,r.jsxs)("div",{children:[(0,r.jsxs)(P.Z,{subheader:(0,r.jsxs)(A.Z,{children:["\uac80\uc0c9\uacb0\uacfc: ",f,"\uba85"]}),children:[null===i||void 0===i?void 0:i.map((function(n){return(0,r.jsx)(k.Z,{children:(0,r.jsx)(e.PatientComponent,{patient:n})})})),(0,r.jsx)(k.Z,{children:(0,r.jsx)(E.Z,{page:x,onChange:function(e,n){m((n-1)*d),g(n)},count:Math.ceil(f/d)})})]}),(0,r.jsx)(t,{})]})}var I=t(69651),B=t(26658),U=t(94);function N(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function R(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?N(Object(t),!0).forEach((function(n){(0,u.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var $=(0,h.forwardRef)((function(e,n){return(0,r.jsx)(x.Z,R({direction:"up",ref:n},e))}));function z(e){var n,t,u,s,o=(0,h.useState)(),a=o[0],i=o[1],c=(0,h.useState)(!1),l=c[0],f=c[1],p=(0,h.useState)({userId:{equals:null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.id}}),d=p[0],v=p[1];(0,h.useEffect)((function(){v((function(n){var t;return R(R({},n),{},{userId:{equals:null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.id}})}))}),[null===(t=e.user)||void 0===t?void 0:t.id]);var j=function(){e.setOpen(!1)},y=function(){var e=(0,b.Z)(Z().mark((function e(n){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(n),f(!0);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,U.Z)({dep:null===e||void 0===e||null===(u=e.user)||void 0===u?void 0:u.id,param:"userModal",defaultValue:e.open?"true":"false",onChange:function(e){"false"===e&&j()},pushWhen:e.open,pushValue:"true",replaceWhen:!e.open,replaceValue:"false"}),(0,r.jsxs)(w.Z,{fullScreen:!0,scroll:"body",open:e.open,onClose:j,TransitionComponent:$,children:[(0,r.jsx)(m.ZP,{title:"".concat(null===(s=e.user)||void 0===s?void 0:s.name," \uace0\uac1d\uc815\ubcf4"),position:"sticky",actionComponent:(0,r.jsx)(O.Z,{color:"inherit",onClick:j,children:(0,r.jsx)(C.Z,{})})}),(0,r.jsx)(S,{user:e.user}),(0,r.jsx)(T,{where:d,PatientComponent:function(e){return(0,r.jsx)(g.Z,{style:{width:"100%"},onClick:function(){return y(e.patient)},children:(0,r.jsx)(I.Z,{patient:e.patient})})}}),(0,r.jsx)(B.Z,{patient:a,open:l,setOpen:f})]})}var M=t(34699),F=t(46829),G=t(32465),H=t(33121);function J(){var e=(0,G.Z)(["\n    query Users($where: UserWhereInput, $orderBy: UserOrderByInput, $skip: Int, $take: Int) {\n        users: usersWithOffset(where: $where, orderBy: $orderBy, skip: $skip, take: $take) {\n            id\n            name\n            phoneNum\n            createdAt\n            agreeTermsOfAd\n            signUpType\n            patients {\n                id\n                type\n                escorts {\n                    id\n                    status\n                    startBookTime\n                }\n                formResults(orderBy: {priority: desc}) {\n                    id\n                    title\n                    outputs(orderBy: {priority: desc}) {\n                        id\n                        type\n                        label\n                        values\n                    }\n                }\n            }\n        }\n    }\n"]);return J=function(){return e},e}var L=(0,H.ZP)(J());function Q(){var e=(0,G.Z)(["\n    query UsersCount($where: UserWhereInput) {\n        usersCount(where: $where)\n    }\n"]);return Q=function(){return e},e}var X=(0,H.ZP)(Q());function K(){var e=(0,F.useLazyQuery)(X),n=(0,M.Z)(e,2),t=n[0],r=n[1],u=r.data,s=r.loading;r.error;function o(){return(o=(0,b.Z)(Z().mark((function e(n){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({variables:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{fetchUsersCount:function(e){return o.apply(this,arguments)},usersCount:null===u||void 0===u?void 0:u.usersCount,loading:s}}var Y=t(72952),ee=t(67102),ne=t(87690),te=t(48862),re=t(75481);function ue(e){var n=(0,Y.Z)(),t=function(){var e=(0,F.useLazyQuery)(L),n=(0,M.Z)(e,2),t=n[0],r=n[1],u=r.data,s=r.loading;return r.error,{fetchUsers:t,users:null===u||void 0===u?void 0:u.users,loading:s}}(),u=t.fetchUsers,s=t.users,a=K(),i=a.fetchUsersCount,c=a.usersCount,l=function(){i({where:e.where}),u({variables:{where:e.where,orderBy:e.orderBy,skip:p*j,take:j}})},f=(0,h.useState)(0),p=f[0],d=f[1],v=(0,h.useState)(50),j=v[0],m=v[1];return(0,h.useEffect)((function(){l()}),[]),(0,_.Z)({timeout:0,dependencies:[e.where,e.orderBy,j],onTimeout:function(){return d(0)}}),(0,_.Z)({timeout:350,dependencies:[e.where,e.orderBy,p,j],onTimeout:l}),(0,r.jsxs)(P.Z,{children:[(0,r.jsx)(k.Z,{disableGutters:!0,children:(0,r.jsx)(o.Z,{primary:"\uc870\uac74\ubd80 \uac80\uc0c9\uacb0\uacfc",secondary:"".concat(c,"\uba85")})}),(0,r.jsx)(k.Z,{disableGutters:!0,children:(0,r.jsx)(re.Z,{onClickRow:e.onClickRow,maxHeight:n.height-250,columns:[{id:"id",label:"\uace0\uac1d\uba85",format:function(e,n){return n.name}},{id:"phoneNum",label:"\uc5f0\ub77d\ucc98"},{id:"createdAt",label:"\uac00\uc785\uc77c",format:ne.TD},{id:"signUpType",label:"\uac00\uc785\ubc29\uc2dd",format:se},{id:"agreeTermsOfAd",label:"\uc218\uc2e0\ub3d9\uc758",format:function(e){return e?"\ub3d9\uc758":"\ubbf8\ub3d9\uc758"}},{id:"patients",label:"\ub4f1\ub85d\ud658\uc790",format:function(e){return null===e||void 0===e?void 0:e.reduce((function(e,n,t){return e+(0!==t?", ":"")+(0,te.DF)(n)}),"")}}],rows:s,csvAvailable:!0,paginationMod:{totalCount:c||0,page:p,rowsPerPage:j,onPageChange:function(e,n){d(n)},onRowsPerPageChange:function(e){m(parseInt(e.target.value,10)),d(0)}}})})]})}function se(e){switch(e){case ee.o_.Apple:return"\uc560\ud50c\ub85c\uadf8\uc778";case ee.o_.Kakao:return"\uce74\uce74\uc624";case ee.o_.PhoneNum:return"\ud734\ub300\ud3f0\ubc88\ud638"}}var oe=t(26381);function ae(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ie(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ae(Object(t),!0).forEach((function(n){(0,u.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ae(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function ce(e){var n=(0,h.useState)(!1),t=n[0],u=n[1],y=(0,h.useState)(),Z=y[0],b=y[1],x=K(),g=x.fetchUsersCount,w=x.usersCount,O=x.loading,C=(0,h.useState)(new Date("2021-01-01")),P=C[0],k=C[1],S=(0,h.useState)(new Date),A=S[0],E=S[1],q=(0,h.useState)(""),D=q[0],V=q[1],W=(0,h.useState)({isClosedAccount:{equals:!1}}),_=W[0],T=W[1],I=(0,h.useState)(),B=I[0],U=I[1],N=(0,h.useState)({createdAt:ee.As.Asc}),R=N[0],$=N[1],M=(0,h.useCallback)((function(e){T((function(n){return ie(ie({},n),{},{patients:{some:e}})}))}),[]);return(0,h.useEffect)((function(){g({where:{isClosedAccount:{equals:!1}}})}),[]),(0,h.useEffect)((function(){T((function(e){return ie(ie({},e),{},{isClosedAccount:{equals:!1},createdAt:{gte:P.toISOString(),lte:A.toISOString()},patients:0!==D.length?{some:{formResults:{some:{title:{startsWith:"\ud658\uc790 \uae30\ubcf8\uc815\ubcf4"},outputs:{some:{label:{startsWith:"\ud658\uc790 \uc131\ud568"},values:{equals:[D]}}}}}}}:void 0})}))}),[P,A,D]),(0,r.jsxs)("div",{children:[(0,r.jsx)(m.ZP,{position:"sticky",actionComponent:(0,r.jsx)(m.v2,{}),title:"\uace0\uac1d \ubaa9\ub85d"}),(0,r.jsxs)(oe.Z,{children:[(0,r.jsxs)(s.Z,{container:!0,spacing:3,children:[(0,r.jsx)(s.Z,{item:!0,xs:12,children:(0,r.jsx)(o.Z,{primary:"\ucd1d \uac00\uc785\uace0\uac1d \uc218",secondary:O?(0,r.jsx)(a.Z,{}):"".concat(w,"\uba85")})}),(0,r.jsx)(s.Z,{item:!0,xs:12,children:(0,r.jsx)(i.Z,{variant:"fullWidth"})}),(0,r.jsx)(s.Z,{item:!0,children:(0,r.jsx)(j.Z,{label:"(\uac00\uc785\uc77c) \uac80\uc0c9\uc2dc\uc791\uc77c",day:j.J.START,defaultDate:"2021-01-01",onChange:function(e){k(e)}})}),(0,r.jsx)(s.Z,{item:!0,children:(0,r.jsx)(j.Z,{label:"(\uac00\uc785\uc77c) \uac80\uc0c9\uc885\ub8cc\uc77c",day:j.J.END,onChange:function(e){E(e)}})}),(0,r.jsx)(s.Z,{item:!0,children:(0,r.jsx)(v.SA,{onChange:M,onChangeValue:function(e){return V(e)}})}),(0,r.jsx)(s.Z,{item:!0,xs:12,children:(0,r.jsx)(i.Z,{variant:"fullWidth"})}),(0,r.jsx)(s.Z,{item:!0,children:(0,r.jsxs)(c.Z,{component:"fieldset",size:"small",children:[(0,r.jsx)(l.Z,{component:"legend",children:"\uacb0\uacfc\ub0b4 \uc815\ub82c \uae30\uc900"}),(0,r.jsxs)(f.Z,{row:!0,value:B,onChange:function(e){var n=e.target.value;switch(U(n),n){case"\ucd5c\uc2e0\uc21c":$({createdAt:ee.As.Desc});break;case"\uc624\ub798\ub41c\uc21c":$({createdAt:ee.As.Asc});break;case"\u3131\u3134\u3137\uc21c":$({name:ee.As.Asc});break;case"\u314e\u314d\u314c\uc21c":$({name:ee.As.Desc})}},children:[(0,r.jsx)(p.Z,{value:"\ucd5c\uc2e0\uc21c",control:(0,r.jsx)(d.Z,{size:"small"}),label:"\ucd5c\uc2e0\uc21c"}),(0,r.jsx)(p.Z,{value:"\uc624\ub798\ub41c\uc21c",control:(0,r.jsx)(d.Z,{size:"small"}),label:"\uc624\ub798\ub41c\uc21c"}),(0,r.jsx)(p.Z,{value:"\u3131\u3134\u3137\uc21c",control:(0,r.jsx)(d.Z,{size:"small"}),label:"\u3131\u3134\u3137\uc21c"}),(0,r.jsx)(p.Z,{value:"\u314e\u314d\u314c\uc21c",control:(0,r.jsx)(d.Z,{size:"small"}),label:"\u314e\u314d\u314c\uc21c"})]})]})})]}),(0,r.jsx)(ue,{where:_,orderBy:R,onClickRow:function(e){b(e),u(!0)}}),(0,r.jsx)(z,{open:t,setOpen:u,user:Z})]})]})}},58509:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users/list",function(){return t(92811)}])}},function(e){e.O(0,[9774,3662,2678,4885,9351,1866,1769,8883,4593,110,5307,8286,953,3052,2079,2346,5537,6697,8696,3031,5191,9081,5862,9120],(function(){return n=58509,e(e.s=n);var n}));var n=e.O();_N_E=n}]);